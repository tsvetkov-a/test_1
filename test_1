Если ppo_orders.ent_rec_id is not null, то выводим адрес Грузополучателя:
Ppo_orders.ent_rec_id => ent_entities.id = ent_addresses.ent_id = > ent_addresses.compact_adr (where main_addr = ‘Y’)
Иначе выводим адрес заказчика, ppo_orders.ent_rec_id is null
Ppo_orders.ent_id => ent_entities.id

      (select case when o.ent_rec_id is not null then adr.compact_adr else ent.id from ppo_orders o 
left join ent_entities ent on o.ent_rec_id = ent.id or o.ent_id = ent.id left join ent_addresses adr on ent.id = adr.ent_id and adr.main_addr = 'Y') дать название



Решение:


4.  {краткое наимен. Инв_счёт_комм}
Если ppo_orders.ent_inv_id заполнено, 
то выводить значение ent_entites.short_name соответствующее ppo_ordres.inv_id = ent_entities.id
Иначе – пусто.
Если инвестор в заказе заполнен, то выводим его. Его нет, то пусто.

(select case when o.ent_inv_id is not null then ent.short_name else null from ppo_orders o left join ent_entities ent on o.ent_inv_id = ent.id) дать название


{Адрес_инв_счёт_комм}
Если ppo_orders.inv_id is not null, то выводим адрес Инвестора:
Ppo_orders.inv_id => ent_entities.id = ent_addresses.ent_id = > ent_addresses.compact_adr (where main_addr = ‘Y’)
, (select case when o.inv_id is not null then adr.compact_adr else null from ppo_orders o 
left join ent_entities ent on o.inv_id = ent.id left join ent_addresses adr on ent.id = adr.ent_id and adr.main_addr = 'Y') дать название

