function emp_link(e_id number, p_subj varchar2 := '', p_body varchar2 := '') return varchar2 is
    lnk varchar(32000);
    aname varchar2(255);
    email varchar2(255);
    displayname varchar2(255);
    l_subj varchar(32000) := utl_url.escape(p_subj, false, 'utf8');
    l_body varchar(32000) := utl_url.escape(p_body, false, 'utf8');
  begin
    select admin_name into aname from ref_employees where id = e_id;
    ldap.s_open;
    email := ldap.search_attr(aname);
    displayname := ldap.search_attr(aname, 'displayname');
    ldap.s_close;
    if email is not null then
      select nvl2(displayname, '"'||displayname||'" <'||email||'>', email) into lnk from dual;
      lnk := utl_url.escape(lnk, true, 'utf8');
      select '<a href="mailto:'||lnk||nvl2(p_subj, '?subject='||l_subj, '')||nvl2(p_body, nvl2(p_subj, '&', '?')||'body='||l_body, '')||'">'||displayname||'</a>' into lnk from dual;
    end if;
    return lnk;
  exception
    when no_data_found then return '';
  end;


